# name: Deploy Application

# on:
#   push:
#     branches:
#       - development
#   pull_request:
#     branches:
#       - development

# jobs:
#   build-and-deploy:
#     runs-on: ubuntu-latest

#     steps:
#       # - name: Checkout code
#       #   uses: actions/checkout@v3
#       #   with:
#       #     fetch-depth: 0

#       # - name: Set up Node.js
#       #   uses: actions/setup-node@v3
#       #   with:
#       #     node-version: '20'

#       - name: Set up SSH key
#         run: |
#           mkdir -p ~/.ssh
#           echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
#           chmod 600 ~/.ssh/id_rsa
#           ssh-keyscan github.com >> ~/.ssh/known_hosts

#       # - name: Change Git remote URL to SSH
#       #   run: git remote set-url origin git@github.com:sefact0ry/sef-admin-panel-server.git

#       # - name: Print current directory
#       #   run: pwd # Prints the current working directory

#       # - name: List contents of current directory
#       #   run: ls -al # Lists all files and directories in the current directory

#       # - name: Debug local git logs
#       #   run: git log --oneline --decorate -n 10

#       # - name: Debug remote git logs
#       #   run: git log origin/development --oneline --decorate -n 10

#       # - name: Pull latest changes from development branch
#       #   run: git checkout development && git pull origin development

#       # - name: Install dependencies
#       #   run: npm install

#       # - name: Build the project
#       #   run: npm run build

#       - name: Redeploy
#         run: npm run redeploy:dev
#         env:
#           SSH_KEY: ${{ secrets.SSH_PRIVATE_KEY }}

# env:
#   CI: true

name: Deploy Application

on:
  push:
    branches:
      - development
  pull_request:
    branches:
      - development

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Set up SSH key
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan github.com >> ~/.ssh/known_hosts

      - name: Navigate to sef-admin-panel-server folder
        run: cd ~

      - name: Navigate to sef-admin-panel-server folder
        run: ls # List contents of the current directory

      - name: Redeploy
        run: |
          cd sef-admin-panel-server
          npm run redeploy:dev
        env:
          SSH_KEY: ${{ secrets.SSH_PRIVATE_KEY }}

env:
  CI: true
